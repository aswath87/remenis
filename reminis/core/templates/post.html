{% extends "remenis_base_nav.html" %}

        {% block head_extra %}
        <link href="/static/css/calendar.css" rel="stylesheet" type="text/css" media="screen"/>
        <link href="/static/css/ui-lightness/jquery-ui-1.8.21.custom.css" rel="stylesheet" type="text/css"/>
        {% endblock %}
        
        {% block content %}
        <div class="span9">
            <div class="hero-unit">
<!--                <h1>Post a story!</h1>-->
                
                <div class="row-fluid">
                    <div class="span4">
                        
                        <div class="modal hide fade" id="myModal" style="display: none;">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">Ã—</button>
                                <h3>Post a story!</h3>
                            </div>
                            <form action="/post/" method="post" name="submitForm" style="margin-bottom:0;" onsubmit="return validateForm()">
                                <div class="modal-body">
                                    <p>Title: <input type="text" class="input-xlarge" name="title" value="{{ title }}" placeholder="(optional)"></p>
                                    <p id="errortext" style="color: red;"></p>
                                    <p>Tell us a story: <textarea name="story" class="input-xlarge" rows="10" cols="500"></textarea></p>
                                    <!--<p>Date: <input id="datepicker" type="text" class="input-large" name="story_date" value="{{ story_date }}"></p>-->
                                    <p>
                                        <div id="date_div" style="font-size: 18;">
                                            Date:
                                            <select id="date_year_select" name="story_date_year" style="width: 100px;"></select>
                                            <button id="add_month_button" type="button" style="margin-bottom: 7px;" onclick="addMonth()">+ add month</button>
                                        </div>
                                    </p>
                                </div>
                                <div class="modal-footer">
                                    <a href="#" class="btn" data-dismiss="modal">Close</a>
                                    <input name="submitButton" type="submit" class="btn btn-primary" style="width: 75px;" value="Submit &raquo;">
                                </div>
                            </form>
                        </div>
                            
                        <a data-toggle="modal" href="#myModal" class="btn btn-primary btn-large">Post &raquo;</a>
                    </div><!--/span-->
                </div><!--/row-->
            </div>
        </div><!--/span-->
        {% endblock %}
        
        {% block load_javascript %}
        <!-- Placed at the end of the document so the pages load faster -->
        <script src="/static/js/jquery.js"></script>
        <script src="/static/js/bootstrap.min.js"></script>
        <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
        <script>
            $(function() {
                              $( "#datepicker" ).datepicker();
              
                              var today = new Date();
                              var currentYear = today.getFullYear();
              
                              for (i = currentYear; i >= 1900; i--)
                              {
                                  var newoption = document.createElement('option');
                                  newoption.innerHTML = i;
                                  document.getElementById("date_year_select").appendChild(newoption);
                              }
            });
            $('#myModal').on('hidden', function () {
                             });
            
            function addMonth()
            {
                var newselect = document.createElement('select');
                newselect.id = "date_month_select";
                newselect.setAttribute('name', "story_date_month");
                newselect.setAttribute('style', "width: 100px; margin-right: 5px;");
                newselect.setAttribute('onchange', "updateDays()");
                newselect.innerHTML = "<option>---</option><option>Jan</option><option>Feb</option><option>Mar</option><option>Apr</option><option>May</option><option>Jun</option><option>Jul</option><option>Aug</option><option>Sep</option><option>Oct</option><option>Nov</option><option>Dec</option>";
                document.getElementById("date_div").appendChild(newselect);
                
                var oldmonthbutton = document.getElementById('add_month_button');
                document.getElementById("date_div").removeChild(oldmonthbutton);
                
                var newdaybutton = document.createElement('button');
                newdaybutton.id = "add_day_button";
                newdaybutton.setAttribute('type', "button");
                newdaybutton.setAttribute('style', "margin-bottom: 7px;");
                newdaybutton.setAttribute('onclick', "addDay()");
                newdaybutton.innerHTML = "+ add day";
                document.getElementById("date_div").appendChild(newdaybutton);
            }
            
            function addDay()
            {
                var newselect = document.createElement('select');
                newselect.id = "date_day_select";
                newselect.setAttribute('name', "story_date_day");
                newselect.setAttribute('style', "width: 100px;");
                document.getElementById("date_div").appendChild(newselect);
                updateDays();
                
                var olddaybutton = document.getElementById('add_day_button');
                document.getElementById("date_div").removeChild(olddaybutton);
            }
            
            function updateDays()
            {
                var monthselect = document.getElementById('date_month_select');
                var dayselect = document.getElementById('date_day_select');
                
                var numdays = 0;
                if (monthselect.value == "---")
                {
                    numdays = 0;
                }
                else if (monthselect.value == "Feb")
                {
                    numdays = 28;
                }
                else if (monthselect.value == "Apr" || monthselect.value == "Jun" || monthselect.value == "Sep" || monthselect.value == "Nov")
                {
                    numdays = 30;
                }
                else
                {
                    numdays = 31;
                }
                
                dayselect.innerHTML = "<option>---</option>";
                for (i = 1; i <= numdays; i++)
                {
                    dayselect.innerHTML += "<option>" + i + "</option>";
                }
            }
        </script>
        <script>
            function validateForm() { 
                document.submitForm.submitButton.disabled = true; 
                //stuff goes here 
                if (document.submitForm.story.value == "")
                {
                    document.getElementById('errortext').innerHTML = "You must input a story!";
                    document.submitForm.submitButton.disabled = false;
                    return false;
                }
                else
                {
                    document.submitForm.submit();
                }
            }
        </script>
        {% endblock %}
